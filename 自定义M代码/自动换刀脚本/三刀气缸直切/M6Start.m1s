OtPort1 = 10  'output#4OtPort2 = 11  'output#5OtPort3 = 12  'output#6GotoSafeZ()NowPosX=GetOEMDro( 800 )NowPosY=GetOEMDro( 801 )OldTool=GetOEMDRO(1200) 'Tool in spindle DRO You must add this to your settings screentool = GetSelectedTool()NewTool=toolMaxToolNum=3 'Max number off tools for the changer'  最大刀数If NewTool =OldTool Then   Exit Sub End If If OldTool=0 Then     SetUserDRO(1200,NewTool)     SetCurrentTool(NewTool)    Select Case NewTool        Case Is=0         DeActivateSignal(OtPort1)         DeActivateSignal(OtPort2)         DeActivateSignal(OtPort3)    Case Is=1         ActivateSignal(OtPort1)         DeActivateSignal(OtPort2)         DeActivateSignal(OtPort3)    Case Is=2              DeActivateSignal(OtPort1)         ActivateSignal(OtPort2)         DeActivateSignal(OtPort3)    Case Is=3              DeActivateSignal(OtPort1)         DeActivateSignal(OtPort2)         ActivateSignal(OtPort3)End Select            Exit SubEnd IfWhile NewTool >MaxToolNum  NewTool=Question("Enter New Tool Number up to " & MaxToolNum)Wend  Xpos=0Ypos=0'收回所有刀  DeActivateSignal(OtPort1)   DeActivateSignal(OtPort2)   DeActivateSignal(OtPort3)          Select Case  NewTool    Case Is=0        Xpos=0        Ypos=0    Case Is=1	If OldTool=2 Then          Xpos=160.8  '第一把刀相对第二把刀的偏移          Ypos=0.00	elseif OldTool=3 Then          Xpos=317.7  '第一把刀相对第三把刀的偏移          Ypos=-0.4	    End If                      Case Is=2       If OldTool=1 Then            Xpos=-160.8  ' 第二把刀相对第一把刀的偏移            Ypos=0.00           elseif OldTool=3  Then 	   Xpos=156.9  ' 第二把刀相对第三把刀的偏移              Ypos=0.00          End If 		     Case Is=3        If OldTool=1 Then            Xpos=-317.7    ' 第三把刀相对第一把刀的偏移            Ypos=-0.4	 elseif OldTool=2  Then 	    Xpos=-156.9   ' 第三把刀相对第二把刀的偏移               Ypos=0.00	  End If               End SelectCode"G4P4" 'Code"G00G91X"& Xpos & "Y" &Ypos'  While IsMoving()'Wend' Code"G4P0.5"newposX=NowPosX-XposnewposY= NowPosy-YposSetOEMDro(800,newposX)SetOEMDro(801,newposY)Code"G4P0.2"'Code"G90G00X"& NowPosX & "Y"& NowPosy '  While IsMoving()'Wend SetUserDRO(1200,NewTool)'放下对应的刀具Select Case  NewTool    Case Is=0           DeActivateSignal(12)           DeActivateSignal(11)            DeActivateSignal(10)    Case Is=1	DeActivateSignal(12)           DeActivateSignal(11)            ActivateSignal(10)		                  Case Is=2	 DeActivateSignal(12)            DeActivateSignal(10)            ActivateSignal(11)     Case Is=3            DeActivateSignal(10) 	DeActivateSignal(11)            ActivateSignal(12)     End Select SetCurrentTool(NewTool)Code"G4P4"                                               