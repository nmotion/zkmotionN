'P 孔结束深度Parg=Param1()'Q 螺距Qarg=param2()'R 开始攻丝高度Rarg=param3()'Message "P=" & Parg & "Q=" & Qarg & "R=" & Rarg '一次进N个螺距ND=2  '下攻螺距数If Parg=0 Or Qarg=0  Then  Message "P Q   can't be zero!"  Exit SubEnd IfCode("G1Z" & Rarg) While IsMoving()WendCPos  = GetOemDro(805)FSpeed = GetOemDro(818)'Rog=Abs(Parg/Qarg)CAim=CPos Cback=CAim DigRate=FSpeed*360 Mdeep =Abs(Rarg-Parg)DigAim = Rarg DigDeep = 0 Do   DigAim=DigAim-Qarg*ND DigDeep=DigDeep+Qarg*ND+0.2 Rog = Abs((Rarg-DigAim)/Qarg)  CAim =CPos+Rog*360    Code("G1Z" & DigAim & "C" & CAim & "F" & DigRate  )  Code("G4P1")  Code("G1Z" & Rarg & "C" & Cback & "F" & DigRate)   Code("G4P2")Loop Until  Abs(DigDeep) > Abs(Mdeep )Code("G1F" & FSpeed )                           